---
layout: default
title: Kobalt by Cedric Beust
description: A modern, versatile build system
isHome: true
---

<section class="bs-docs-section">
  <h1 id="overview" class="page-header">Overview</h1>
  
  <blockquote>
    Kobalt is a build system inspired by Gradle and Maven. It reuses the best concepts from these two successful and popular build systems while adding a few modern features of its own.
  </blockquote>

  <h3 id="features">Features</h3>

  <ul class="features">
    <li>Clean, minimal syntax for build files</li>
    <li>Build file auto-completion in your IDE</li>
    <li>Incremental tasks</li>
    <li>Intuitive plug-in architecture</li>
  </ul>
  
  <h3 id="examples">Example: JCommander's entire build file</h3>
  
{% highlight kotlin linenos %}
import com.beust.kobalt.*
import com.beust.kobalt.plugin.java.*
import com.beust.kobalt.plugin.packaging.*
import com.beust.kobalt.plugin.publish.*
 
val jcommander = project {
    name = "jcommander"
    group = "com.beust"
    artifactId = name
    version = "1.52"
 
    dependenciesTest {
        compile("org.testng:testng:6.9.5")
    }
 
    assemble {
        mavenJars {
        }
    }
 
    bintray {
        publish = false
    }
}
{% endhighlight %}

</section>


<section class="bs-docs-section">
  <h1 id="installation" class="page-header">Installation</h1>

  <h3 id="install-jekyll">IntelliJ Plugin</h2>
  <p>The easiest way to get started is to install the IntelliJ plugin. Search for Kobalt in Preferences -> Plugins -> Browse Repositories</p>

  <h3 id="install-jekyll">Command-Line Install</h2>
  <p>If you want to run your tests and builds from the command line, this is currently the most reliable way to install Kobalt.<p>
    <p> Note that you must first install jq.  On MacOS use <code>brew install jq</code> and on Ubuntu try <code>sudo apt-get install jq</code></p>

    <ol>
      <li>Install kobalt</li>
{% highlight bash %}
LATEST_KOBALT_URL=`curl -s https://api.github.com/repos/cbeust/kobalt/releases/latest | jq -r ".assets[0] | .browser_download_url" `
LATEST_KOBALT_ZIP=`echo "$LATEST_KOBALT_URL" | rev | cut -d / -f 1 | rev`
LATEST_KOBALT=`echo "$LATEST_KOBALT_ZIP" | sed 's/.zip//'

mkdir -p ~/.kobalt/wrapper/dist/
cd ~/.kobalt/wrapper/dist/
curl -LO $LATEST_KOBALT_URL
unzip -o $LATEST_KOBALT_ZIP
chmod +x $LATEST_KOBALT/bin/kobaltw
export PATH=~/.kobalt/wrapper/dist/$LATEST_KOBALT/bin:$PATH
{% endhighlight %}
    <li>Go into your project's directory</li>
    <li>Initialize your project as a Kobalt project.  This will install kobaltw (wrapper) in your project and create the <code>kobalt/src/Build.kt</code> file
{% highlight bash %}
kobaltw --init kotlin
{% endhighlight %}
    </li>
    <li>Ensure you've got the Kobalt Intellij plugin installed (v1.110 or better)</li>
    <li>Import into IntelliJ
      <p>File -> New -> Project from existing sources -> (your project's path) -> Import project from external model (Kobalt)
  Select option "use auto-import"</p>
    </li>
    <li>You can now use the refresh/sync icon in the kobalt sidebar tool (shows up on far right, below Maven Projects on my IDE) to get your dependencies configured in IntelliJ.</li>
</ol>

<div class="panel panel-default">
  <div class="panel-heading">Notes</div>
  <div class="panel-body">
    <ul>
      <li> You may get this error message when you first import the project b/c Kotlin will not be configured
          <code>AssertionError: Kotlin library should exists when adding sources root</code>
      <li> This happens because your source folders have been marked as such but you have not yet configured Kotlin java for the project
      <li> You can fix the error by using the configure Kotlin dialog that will usually show up under the error message or by going to tools -> Kotlin -> Configure Kotlin in project
    </ul>
</div>
</div>

</section>


<section class="bs-docs-section">
  <h1 id="usage" class="page-header">Usage</h1>

  The most common things you'll do with Kobalt are
  <ul>
    <li><h3 id="editBuild">Edit the build file</h3>
      <p>Unless your project is new, the build file generated by default will need some editing before you can build, so take a look at <code>kobalt/src/Build.kt</code> and adjust whatever is necessary (e.g. package name, version, dependencies).</p>
      <p>For details, check out the <a href="/buildkt.html">Build File Reference</a></p>
    </li>
    <li><h3 id="runTests">Run tests</h3>
      <p>Use <code>./kobaltw test</code> from the command line or the Kobalt Intellij plugin<p>
    </li>
    <li><h3 id="runApp">Run your app</h3>
      <p>If you've configured a main class with the <code>application</code> directive, use <code>./kobaltw run</code> from the command line or the Kobalt intellij plugin<p>
    </li>
    <li><h3 id="assembleJar">Assemble a jar file</h3>
      <p>Use <code>./kobaltw assemble</code> from the command line or the Kobalt intellij plugin<p>
    </li>
    <li><h3 id="uploadMaven">Upload to Maven Central, etc</h3>
      <p>JCenter and Bintray support is also included in Kobalt</p>
    </li>
    <li><h3 id="usePlugins">Use or create plugins</h3>
    </li>
</section>

<section class="bs-docs-section">
  <h1 id="about" class="page-header">About</h1>

  <h3 id="editBuild">License</h3>
  <p>
    Kobalt is <a href="https://github.com/cbeust/kobalt/blob/master/LICENSE.txt">licensed under Apache 2.0</a>
  </p>

  <h3 id="editBuild">Author</h3>
  <p>
    Kobalt is written by <a href="http://beust.com/weblog/">CÃ©dric Beust</a>.
  </p>
  <p>
    <a href="https://github.com/dmitry-zhuravlev">Dmitry Zhuravlev</a> contributed many improvements to the IntelliJ plugin.
  </p>
  <p>
    <a href="https://github.com/evanchooly">Justin Lee</a> contributed improvements to the bintray upload.
  </p>

  <h3 id="editBuild">Status</h3>
  <p>Kobalt works very well for most JVM and Android apps but given its rapid pace of change, there can be surprises.
    <a href="https://github.com/cbeust/kobalt/issues">Issues are tracked on github</a>
  </p>

  <h3 id="editBuild">Working on Kobalt</h3>
  <ol>
    <li><h4>Edit kobalt.version</h4>
      <p>
        Edit the file <code>src/main/resources/kobalt.properties</code> and set it to a nonexistent version. For example, if the current version is <code>0.812</code>, set it to <code>0.813</code>.
      </p>

{% highlight properties %}
kobalt.version=0.400
{% endhighlight %}
      <p>
        When you launch Kobalt from IDEA with a nonexistent version, Kobalt will show a message saying that it couldn't locate that version and instead, it will use the classes generated by IDEA. This way, you will always be running the files that you just modified with IDEA. On start up, Kobalt will display a message looking like:
      </p>
{% highlight text %}
Couldn't find .../kobalt-0.400.jar, using ...
{% endhighlight %}

      <p>
        Note that at the moment, Kobalt expects to be located in <code>$HOME/kotlin/kobalt</code>.
      </p>
    </li>
    <li><h4>Launch configuration</h4>
      <p>
        Kobalt's main class is com.beust.kobalt.MainKt. Here is a typical launch configuration for IntelliJ IDEA:
      </p>
      <div class="image-wrapper" >
        <img src="/images/launch-configuration.png"/>
      </div>
      A few observations:
      <ul>
        <li>You can ask Kobalt to build external projects by specifying a non-empty "Working Directory".
        <li>The default log level is 1. 2 is useful for debugging and 3 will be extremely verbose.
        <li>Another command line parameter worth of notice is <code>--dev</code>, which will add the class name and thread information to each log line.
        <li>Checking the "Single instance" box is useful to avoid duplicating these launch configurations.
      </ul>
    </li>
  </ol>

</section>